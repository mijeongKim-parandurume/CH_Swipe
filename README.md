# 천상열차분야지도 - Celestial Chart Interactive Experience

조선시대 천문도의 6단계 레이어를 스와이프 인터랙션으로 탐험하는 웹 애플리케이션입니다.

## 프로젝트 개요

이 프로젝트는 조선시대의 대표적인 천문도인 **천상열차분야지도**를 현대적인 웹 기술로 재해석한 인터랙티브 교육 콘텐츠입니다. 6단계의 레이어를 스와이프 제스처로 순차적으로 전개하며, 각 단계마다 상세한 설명을 제공합니다.

### 주요 기능

- **6단계 레이어 시스템**: 별 → 별자리 → 자미원 → 적도 → 황도 → 은하수
- **스와이프 인터랙션**: 좌우 스와이프로 단계 이동 (전진/후진)
- **손 제스처 컨트롤**: MediaPipe Hands를 활용한 비접촉 제스처 인터랙션
- **누적 표시**: 이전 레이어는 감쇠되어 유지 (정보 과밀 완화)
- **역재생 효과**: 되감기 시 최근 레이어만 역재생
- **교육 설명 패널**: 각 단계별 상세 설명 제공
- **반응형 디자인**: 데스크톱/모바일 모두 지원
- **접근성**: 키보드 네비게이션, 폰트 크기 조절 지원

## 기술 스택

- **Three.js** (r158): 3D 렌더링 엔진
- **MediaPipe Hands**: 실시간 손 추적 및 제스처 인식
- **WebGL2**: GPU 가속 그래픽스
- **Vanilla JavaScript**: 프레임워크 없는 순수 JavaScript
- **CSS3**: 현대적인 스타일링 및 애니메이션
- **GLB Format**: 최적화된 3D 모델 포맷

## 파일 구조

```
CH_Swipe/
├── index.html           # 메인 HTML 파일
├── styles.css           # 스타일시트
├── app.js              # 메인 애플리케이션 로직
├── gesture-handler.js   # 손 제스처 추적 모듈
├── config.json         # 설정 파일
├── README.md           # 프로젝트 문서
└── assets/
    └── 3d-objects/
        ├── CH_01.glb   # 별 (Point Cloud)
        ├── CH_02.glb   # 별자리 연결선
        ├── CH_03.glb   # 자미원
        ├── CH_04.glb   # 적도
        ├── CH_05.glb   # 황도
        └── CH_06.glb   # 은하수
```

## 설치 및 실행

### 1. 로컬 서버 실행

이 프로젝트는 로컬 파일 시스템에서 직접 실행할 수 없습니다 (CORS 정책 때문). 로컬 웹 서버가 필요합니다.

#### Python 사용 (권장)

```bash
# Python 3.x
python -m http.server 8000

# Python 2.x
python -m SimpleHTTPServer 8000
```

#### Node.js 사용

```bash
# http-server 설치
npm install -g http-server

# 서버 실행
http-server -p 8000
```

#### VS Code Live Server 사용

1. VS Code에서 "Live Server" 확장 설치
2. index.html 파일에서 우클릭 → "Open with Live Server"

### 2. 브라우저 접속

로컬 서버 실행 후 브라우저에서 다음 주소로 접속:

```
http://localhost:8000
```

## 사용 방법

### 데스크톱

- **좌우 스와이프**: 터치 또는 키보드 화살표 키로 단계 이동
- **카메라 회전**: 마우스 드래그
- **확대/축소**: 마우스 휠
- **단계 이동**: 키보드 화살표 키 (← →)
- **패널 열기/닫기**: 우측 패널 토글 버튼
- **폰트 크기 조절**: 좌측 상단 A+ / A- 버튼

### 모바일

- **좌우 스와이프**: 한 손가락으로 좌우 드래그
- **카메라 회전/확대**: 두 손가락 제스처
- **단계 선택**: 하단 진행 바의 점(마커) 터치
- **패널 열기/닫기**: 하단 패널 토글 버튼

### 손 제스처 컨트롤 (Hand Gesture Control)

우측 상단의 ✋ 버튼을 클릭하여 손 제스처 추적을 활성화할 수 있습니다.

#### 제스처 활성화 방법

1. **우측 상단 ✋ 버튼 클릭**: 제스처 추적 시작
2. **카메라 권한 허용**: 브라우저에서 카메라 접근 허용
3. **제스처 패널 확인**: 초기화 완료 후 자동으로 카메라 시작
4. **패널 자동 숨김**: 3초 후 패널이 자동으로 숨겨짐 (제스처는 계속 활성화 상태)
5. **패널 다시 보기**: 버튼에 마우스를 올리면 패널이 다시 나타남
6. **제스처 비활성화**: ✋ 버튼을 다시 클릭하여 종료

#### 지원 제스처

| 제스처 | 손 모양 | 동작 | 기능 |
|--------|---------|------|------|
| **스와이프** | 검지 펴기 (Pointing) | 손을 좌우로 이동 | 단계 전환 (← →) |
| **회전** | 주먹 쥐기 (Closed Fist) | 손을 상하좌우로 이동 | 3D 모델 회전 |
| **줌** | 양손 주먹 (Two Fists) | 양손을 벌리거나 모음 | 확대/축소 |

#### 사용 팁

- **조명**: 밝은 환경에서 더 정확한 손 인식 가능
- **배경**: 단순한 배경에서 더 안정적인 추적
- **거리**: 카메라에서 30~60cm 거리 권장
- **손 위치**: 카메라 프레임 내에 손이 완전히 보이도록 유지
- **제스처 전환**: 제스처를 바꿀 때는 잠시 중립 자세(손 내림) 유지

#### 시각적 피드백

- **버튼 상태**:
  - 비활성: 검은색 배경 + 노란색 테두리
  - 활성: 노란색 배경 + 펄스 애니메이션
- **손 추적 시각화**: 캔버스에 손 랜드마크와 중심점 표시
- **상태 메시지**: 현재 제스처 상태 텍스트 표시

## 6단계 레이어 설명

### 1단계: 별 (CH_01.glb)
약 1,465개의 별로 구성된 천구 표현. 관상수시(觀象授時)의 과학적 기반.

### 2단계: 별자리 연결선 (CH_02.glb)
삼원(三垣)과 이십팔수(二十八宿)를 포함한 별자리 체계. 자연에서 문화적 질서로의 전환.

### 3단계: 자미원 (CH_03.glb)
북극성을 중심으로 하는 권역. 왕권과 천명의 상징. 중심에서 외곽으로 확장되는 위계 구조.

### 4단계: 적도 (CH_04.glb)
하늘의 좌표계 기준선. 북위 38도(개성)의 관측 위도 반영. 정량적 천문학의 시각화.

### 5단계: 황도 (CH_05.glb)
태양의 연주 운동 궤적. 적도와 23.5° 기울기. 공간적 구조에서 시간적 질서로의 전환.

### 6단계: 은하수 + 완성 (CH_06.glb)
모든 레이어의 통합. 자연-사회-철학의 합일을 표현하는 완성 단계.

## 설정 커스터마이징

[config.json](config.json) 파일을 수정하여 다양한 설정을 조정할 수 있습니다:

### 애니메이션 설정
```json
"animation": {
  "easing": "easeOutCubic",
  "panelDelay": 300,        // 패널 표시 지연 시간 (ms)
  "swipeThreshold": 50,     // 스와이프 임계값 (px)
  "inertia": 0.92           // 관성 감쇠율
}
```

### 투명도 설정
```json
"opacity": {
  "current": 1.0,           // 현재 레이어 투명도
  "previous": 0.75,         // 이전 레이어 투명도
  "ghost": 0.25             // 되감기 시 고스트 투명도
}
```

### 카메라 설정
```json
"camera": {
  "fov": 60,
  "near": 0.1,
  "far": 1000,
  "initialPosition": [0, 0, 5],
  "rollLimit": 30           // 롤 제한 각도
}
```

## 성능 최적화

- **프리로딩**: 모든 GLB 파일을 사전 로드
- **픽셀 비율 제한**: 모바일에서 최대 2.0으로 제한
- **LOD (Level of Detail)**: 거리에 따른 디테일 조정
- **드로우콜 최소화**: 효율적인 렌더링
- **60fps 목표**: 중간급 기기 기준

## 접근성 (Accessibility)

- **색 대비**: WCAG 2.1 AA 기준 준수
- **키보드 네비게이션**: 모든 기능을 키보드로 조작 가능
- **폰트 크기 조절**: 사용자가 텍스트 크기 조정 가능
- **시맨틱 HTML**: 스크린 리더 지원
- **ARIA 라벨**: 적절한 레이블링
- **Reduced Motion**: 애니메이션 감소 옵션 지원

## 브라우저 지원

- Chrome 90+ (권장)
- Firefox 88+
- Safari 14+
- Edge 90+
- 모바일: iOS Safari 14+, Chrome Android 90+

**필수 요구사항**:
- WebGL2 지원 브라우저
- 손 제스처 사용 시: 카메라 접근 권한 및 MediaPipe 지원

## 문제 해결

### GLB 파일이 로드되지 않는 경우
- 로컬 웹 서버를 통해 실행하고 있는지 확인
- 브라우저 콘솔(F12)에서 CORS 에러 확인
- GLB 파일 경로가 정확한지 확인

### 성능이 느린 경우
- 브라우저의 하드웨어 가속 활성화 확인
- config.json의 `maxPixelRatio` 값을 낮춤 (1.5 또는 1.0)
- 다른 브라우저 탭을 닫아 GPU 리소스 확보

### 스와이프가 작동하지 않는 경우
- 터치 스크린에서 한 손가락으로 좌우 스와이프 시도
- 키보드 화살표 키로 대체 가능
- 브라우저 콘솔에서 JavaScript 에러 확인

### 손 제스처가 작동하지 않는 경우
- **카메라 권한**: 브라우저 설정에서 카메라 권한 허용 확인
- **MediaPipe 로딩**: 브라우저 콘솔에서 MediaPipe 관련 에러 확인
- **손 인식 안됨**:
  - 조명이 충분한지 확인 (어두운 환경에서는 인식률 저하)
  - 카메라에서 30~60cm 거리 유지
  - 손이 카메라 프레임 내에 완전히 보이는지 확인
  - 배경이 복잡하지 않은지 확인
- **제스처 반응 없음**:
  - 제스처 패널의 상태 메시지 확인
  - 손 랜드마크가 캔버스에 표시되는지 확인
  - 다른 제스처로 전환 시 잠시 중립 자세 유지
- **카메라가 시작되지 않음**:
  - 다른 애플리케이션에서 카메라를 사용 중인지 확인
  - 브라우저를 새로고침하여 재시도
  - 다른 브라우저에서 테스트 (Chrome 권장)

## 라이선스

이 프로젝트는 교육 목적으로 제작되었습니다.

## 크레딧

- **천문도 원본**: 조선시대 천상열차분야지도
- **3D 모델링**: [모델 제작자 정보]
- **개발**: Claude & Developer Team
- **기술 스택**:
  - Three.js (3D 렌더링)
  - MediaPipe Hands (손 제스처 인식)
  - WebGL2 (GPU 가속)

## 향후 계획

- [ ] 사계절 별자리 페이지 구현
- [ ] VR/AR 모드 지원
- [ ] 다국어 지원 (영어, 일본어, 중국어)
- [ ] 교육용 퀴즈 시스템
- [ ] 소셜 미디어 공유 기능
- [ ] 텔레메트리 및 사용자 분석

## 문의

프로젝트 관련 문의사항이나 버그 리포트는 이슈 트래커를 이용해주세요.

---

**천상열차분야지도**를 통해 조선시대 천문학의 아름다움과 과학성을 경험해보세요.
